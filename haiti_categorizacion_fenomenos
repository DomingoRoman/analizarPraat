sonido = selected("Sound")
tgrid = selected("TextGrid")
sonido$ = selected$("Sound")

tipo_inform$ = left$(sonido$,3)
select tgrid
n_inter_tgr = Get number of intervals: 2

if n_inter_tgr == 3
	palabra$ = Get label of interval: 2, 2
endif

### extracción del número del informante (dos posibilidades:de uno o de dos dígitos)

largo_palabra = length(palabra$)

largo_nombre = length(sonido$)

primer_guion = index(sonido$, "-")

buscar_guion_nombre$ = left$(sonido$,6)

ultimo$ = right$ (buscar_guion_nombre$,1)

if ultimo$ == "-"
	ene_info$ = mid$(buscar_guion_nombre$,5,1)
else
	ene_info$ = mid$(buscar_guion_nombre$,5,2)
endif

buscar_guion_sexo$ = left$(sonido$,8)

## sexo
buscar_guion_sexo$ = left$(sonido$,8)
ultimo_sex$ = right$ (buscar_guion_sexo$,1)
if ultimo_sex$ == "-"
	sex_info$ = mid$(buscar_guion_sexo$,7,1)
else
	sex_info$ = mid$(buscar_guion_sexo$,8,1)
endif


writeInfoLine : tipo_inform$, tab$, palabra$,tab$, largo_palabra, tab$, largo_nombre,tab$,primer_guion, tab$,
... buscar_guion_nombre$, tab$, buscar_guion_nombre$,tab$, ultimo$,tab$, ene_info$, tab$, buscar_guion_sexo$,tab$,
... sex_info$

select sonido
plus tgrid


form Lista de fenómenos
comment casos de eRe
	boolean ere
	boolean fricativa
	boolean aproximante
	boolean ele_intervocalica
	boolean ele_en_grupo_consonantico
	boolean ele_final_silaba_o_palabra
	boolean omitida_al_final_de_silaba_o_palabra
	boolean omitida_en_grupo_consonantico
	boolean esvarabatico_con_ere
	boolean esvarabatico_con_ele
comment casos de eRRe
	boolean erre
	boolean fricativa
	boolean ere
	boolean ele_inicial
	boolean ele_intervocalica
comment Alargamiento
	boolean erre_alargada
	boolean emision_incomprensible
endform

select tgrid
n  = Get number of intervals: 1
for i to n
    ini [i] = Get start time of interval: 1, i
    fin [i] = Get end time of interval: 1, i
endfor

#	Número de sonidos en la tercera capa
n_sonidos = Get number of points: 3

#	Duración de la palabra
fin = Get end time of interval: 2, 2
ini = Get start time of interval: 2, 2
dur = fin-ini


#	Contar vocales en el estrato 3 para sílabas fonéticas

vocA = Count points where: 3, "contains", "a"
vocE = Count points where: 3, "contains", "e"
vocI = Count points where: 3, "contains", "i"
vocO = Count points where: 3, "contains", "o"
vocU = Count points where: 3, "contains", "u"

silFonet = vocA+vocE+vocI+vocO+vocU


# 	velocidades fonética por sonidos y por sílaba
velFonet =  n_sonidos/dur
velSilFonet = silFonet/dur




# 	Crea tabla de datos
tabla = Create Table with column names: "tabla", n, "informante tipo sexo palabra duracion silFonet velFonet 
... velSilFonet r_ere r_fricativa r_aproximante r_ele_intervocal r_ele_grupo r_ r_ele_final r_omision_final 
...r_omision_grupo ere_esv_ere ere_esv_ele rr_erre rr_fricativa rr_ere rr_ele_inicial rr_ele_intevocal 
... rr_larga emision_incompren"

#	Inserta valores en la tabla de datos

select tabla
Set string value: 1, "informante", ene_info$
Set string value: 1, "sexo", sex_info$
Set string value: 1, "tipo", tipo_inform$
Set string value: 1, "palabra", palabra$
Set numeric value: 1, "duracion", dur
Set numeric value: 1, "velFonet", velFonet
Set numeric value: 1, "silFonet", silFonet
Set numeric value: 1, "velSilFonet", velSilFonet


